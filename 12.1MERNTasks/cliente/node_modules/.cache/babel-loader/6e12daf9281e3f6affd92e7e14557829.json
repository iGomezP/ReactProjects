{"ast":null,"code":"var _jsxFileName = \"/home/vakaz/Documentos/React/12MERNTasks/cliente/src/context/autenticacion/AuthState.jsx\",\n    _s = $RefreshSig$();\n\nimport { useReducer } from \"react\";\nimport AuthContext from \"./AuthContext\";\nimport AuthReducer from \"./AuthReducer\";\nimport clienteAxios from \"../../config/axios\";\nimport TokenAuth from \"../../config/tokenAuth\";\nimport { REGISTRO_EXITOSO, REGISTRO_ERROR, OBTENER_USUARIO, LOGIN_EXITOSO, LOGIN_ERROR, CERRAR_SESION } from \"../../types\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AuthState = props => {\n  _s();\n\n  // State inicial\n  const initialState = {\n    token: localStorage.getItem('token'),\n    autenticado: null,\n    usuario: null,\n    mensaje: null,\n    cargando: null\n  }; // Inicializacion del reducer\n\n  const [state, dispatch] = useReducer(AuthReducer, initialState); // Funciones\n\n  const RegistrarUsuario = async datos => {\n    try {\n      const respuesta = await clienteAxios.post('/api/usuarios', datos); // console.log( respuesta.data );\n\n      dispatch({\n        type: REGISTRO_EXITOSO,\n        payload: respuesta.data\n      }); // Obtener el usuario\n\n      UsuarioAutenticado();\n    } catch (error) {\n      // console.log( error.response.data.msg );\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: 'alerta-error'\n      };\n      dispatch({\n        type: REGISTRO_ERROR,\n        payload: alerta\n      });\n    }\n  }; // Cuando el usuario inicia sesión\n\n\n  const IniciarSesion = async datos => {\n    try {\n      const respuesta = await clienteAxios.post('/api/auth', datos); // console.log( respuesta );\n\n      dispatch({\n        type: LOGIN_EXITOSO,\n        payload: respuesta.data\n      }); // Obtener el usuario\n\n      UsuarioAutenticado();\n    } catch (error) {\n      console.log(error.response.data.msg);\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: 'alerta-error'\n      };\n      dispatch({\n        type: LOGIN_ERROR,\n        payload: alerta\n      });\n    }\n  }; // Retorna el usuario autenticado\n\n\n  const UsuarioAutenticado = async () => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      // Función para enviar el token por headers\n      TokenAuth(token);\n    }\n\n    try {\n      const respuesta = await clienteAxios.get('/api/auth'); // console.log(  );\n\n      dispatch({\n        type: OBTENER_USUARIO,\n        payload: respuesta.data.usuario\n      });\n    } catch (error) {\n      console.log(error.response);\n      dispatch({\n        type: LOGIN_ERROR\n      });\n    }\n  }; // Cierra la sesión del usuario\n\n\n  const CerrarSesion = () => {\n    dispatch({\n      type: CERRAR_SESION\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      // ¿ States\n      token: state.token,\n      autenticado: state.autenticado,\n      usuario: state.usuario,\n      mensaje: state.mensaje,\n      // ¿ Funciones\n      RegistrarUsuario,\n      IniciarSesion,\n      UsuarioAutenticado,\n      CerrarSesion\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthState, \"h4meAN672mISt93ielJXXMKemns=\");\n\n_c = AuthState;\nexport default AuthState;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthState\");","map":{"version":3,"sources":["/home/vakaz/Documentos/React/12MERNTasks/cliente/src/context/autenticacion/AuthState.jsx"],"names":["useReducer","AuthContext","AuthReducer","clienteAxios","TokenAuth","REGISTRO_EXITOSO","REGISTRO_ERROR","OBTENER_USUARIO","LOGIN_EXITOSO","LOGIN_ERROR","CERRAR_SESION","AuthState","props","initialState","token","localStorage","getItem","autenticado","usuario","mensaje","cargando","state","dispatch","RegistrarUsuario","datos","respuesta","post","type","payload","data","UsuarioAutenticado","error","alerta","msg","response","categoria","IniciarSesion","console","log","get","CerrarSesion","children"],"mappings":"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","sourcesContent":["import { useReducer } from \"react\";\nimport AuthContext from \"./AuthContext\";\nimport AuthReducer from \"./AuthReducer\";\nimport clienteAxios from \"../../config/axios\";\nimport TokenAuth from \"../../config/tokenAuth\";\nimport {\n  REGISTRO_EXITOSO,\n  REGISTRO_ERROR,\n  OBTENER_USUARIO,\n  LOGIN_EXITOSO,\n  LOGIN_ERROR,\n  CERRAR_SESION\n} from \"../../types\";\n\nconst AuthState = props => {\n\n  // State inicial\n  const initialState = {\n    token: localStorage.getItem( 'token' ),\n    autenticado: null,\n    usuario: null,\n    mensaje: null,\n    cargando: null\n  }\n\n  // Inicializacion del reducer\n  const [ state, dispatch ] = useReducer( AuthReducer, initialState );\n\n  // Funciones\n  const RegistrarUsuario = async datos => {\n\n    try {\n\n      const respuesta = await clienteAxios.post( '/api/usuarios', datos );\n      // console.log( respuesta.data );\n\n      dispatch( {\n        type: REGISTRO_EXITOSO,\n        payload: respuesta.data\n      } );\n\n      // Obtener el usuario\n      UsuarioAutenticado();\n\n    } catch ( error ) {\n      // console.log( error.response.data.msg );\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: 'alerta-error'\n      }\n\n      dispatch( {\n        type: REGISTRO_ERROR,\n        payload: alerta\n      } );\n    }\n  };\n\n  // Cuando el usuario inicia sesión\n  const IniciarSesion = async datos => {\n\n    try {\n\n      const respuesta = await clienteAxios.post( '/api/auth', datos );\n      // console.log( respuesta );\n      dispatch( {\n        type: LOGIN_EXITOSO,\n        payload: respuesta.data\n      } );\n\n      // Obtener el usuario\n      UsuarioAutenticado();\n\n    } catch ( error ) {\n      console.log( error.response.data.msg );\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: 'alerta-error'\n      }\n\n      dispatch( {\n        type: LOGIN_ERROR,\n        payload: alerta\n      } );\n    }\n  };\n\n  // Retorna el usuario autenticado\n  const UsuarioAutenticado = async () => {\n    const token = localStorage.getItem( 'token' );\n    if ( token ) {\n      // Función para enviar el token por headers\n      TokenAuth( token );\n    }\n\n    try {\n\n      const respuesta = await clienteAxios.get( '/api/auth' );\n      // console.log(  );\n\n      dispatch( {\n        type: OBTENER_USUARIO,\n        payload: respuesta.data.usuario\n      } )\n\n    } catch ( error ) {\n      console.log( error.response );\n      dispatch( {\n        type: LOGIN_ERROR\n      } )\n    }\n  };\n\n  // Cierra la sesión del usuario\n  const CerrarSesion = () => {\n    dispatch( {\n      type: CERRAR_SESION\n    } )\n  }\n\n  return (\n    <AuthContext.Provider\n      value={ {\n        // ¿ States\n        token: state.token,\n        autenticado: state.autenticado,\n        usuario: state.usuario,\n        mensaje: state.mensaje,\n        // ¿ Funciones\n        RegistrarUsuario,\n        IniciarSesion,\n        UsuarioAutenticado,\n        CerrarSesion\n      } }\n    >\n      { props.children }\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthState;"]},"metadata":{},"sourceType":"module"}